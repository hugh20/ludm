(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3e4d469c"],{2423:function(t,e,a){"use strict";a.d(e,"f",function(){return s}),a.d(e,"d",function(){return n}),a.d(e,"b",function(){return r}),a.d(e,"a",function(){return i}),a.d(e,"c",function(){return l}),a.d(e,"e",function(){return c});var o=a("66df"),s=function(t,e,a){return o["a"].request({url:"/api/admin/articles",params:{page:t,per_page:e,search_data:JSON.stringify(a)},method:"get"})},n=function(){return o["a"].request({url:"/api/admin/categories/all",method:"get"})},r=function(t){return o["a"].request({url:"/api/admin/articles/"+t,method:"delete"})},i=function(t){return o["a"].request({url:"/api/admin/articles",data:t,method:"post"})},l=function(t,e){return o["a"].request({url:"/api/admin/articles/"+t,data:e,method:"patch"})},c=function(t){return o["a"].request({url:"api/admin/articles/"+t,method:"get"})}},"711f":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",{attrs:{gutter:24}},[a("Col",{attrs:{xs:6,lg:3}},[a("Button",{attrs:{type:"success",icon:"plus"},on:{click:function(e){t.addBtn()}}},[t._v("添加")])],1),a("Col",{staticClass:"hidden-mobile",attrs:{xs:3,lg:4}},[a("Input",{attrs:{icon:"search",placeholder:"请输入标题..."},model:{value:t.searchForm.title,callback:function(e){t.$set(t.searchForm,"title",e)},expression:"searchForm.title"}})],1),a("Col",{attrs:{xs:3,lg:3}}),a("Col",{attrs:{xs:1,lg:3}},[a("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:function(e){t.getTableDataExcute(t.feeds.current_page)}}},[t._v("Search")])],1)],1),a("br"),a("Row",[t.tableLoading?a("div",{staticClass:"demo-spin-container"},[a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"spin-icon-load",attrs:{type:"load-c",size:"18"}}),a("div",[t._v("加载中...")])],1)],1):t._e(),a("Table",{attrs:{border:"",columns:t.columns,data:t.feeds.data},on:{"on-sort-change":t.onSortChange}}),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{staticClass:"paging",attrs:{total:t.feeds.total,current:t.feeds.current_page,"page-size":t.feeds.per_page,"show-elevator":"","show-total":"","show-sizer":""},on:{"on-change":t.handleOnPageChange,"on-page-size-change":t.onPageSizeChange}})],1)])],1),t.showInfoModal.show?a("show-info",{attrs:{info:t.showInfoModal.info},on:{"show-modal-close":t.showModalClose}}):t._e(),t.addModal.show?a("add-component",{on:{"on-add-modal-success":function(e){t.getTableDataExcute(t.feeds.current_page)},"on-add-modal-hide":t.addModalHide}}):t._e(),t.editModal.show?a("edit-component",{attrs:{"modal-id":t.editModal.id},on:{"on-edit-modal-success":function(e){t.getTableDataExcute(t.feeds.current_page)},"on-edit-modal-hide":t.editModalHide}}):t._e()],1)},s=[],n=(a("7f7f"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Modal",{attrs:{closable:!1,"mask-closable":!1,fullscreen:""},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[a("p",{attrs:{slot:"header"},slot:"header"},[t._v("添加")]),a("Row",[a("Col",{attrs:{span:"16"}},[a("Form",{ref:"formData",attrs:{model:t.formData,rules:t.rules,"label-position":"left","label-width":100}},[a("FormItem",{attrs:{label:"文章："}},[a("Input",{attrs:{value:t.$route.query.article_title,readonly:""}})],1),a("FormItem",{attrs:{label:"标题：",prop:"title"}},[a("Input",{model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1),a("FormItem",{attrs:{label:"封面："}},[a("upload",{attrs:{"upload-config":t.imguploadConfig},on:{"on-upload-change":t.uploadChange},model:{value:t.formData.cover_image,callback:function(e){t.$set(t.formData,"cover_image",e)},expression:"formData.cover_image"}})],1),a("FormItem",{attrs:{label:"关键词：",prop:"keywords"}},[a("Input",{attrs:{type:"textarea",placeholder:"以英文逗号隔开"},model:{value:t.formData.keywords,callback:function(e){t.$set(t.formData,"keywords",e)},expression:"formData.keywords"}}),a("input-helper",{attrs:{text:"以英文逗号隔开"}})],1),a("FormItem",{attrs:{label:"描述：",prop:"description"}},[a("Input",{attrs:{type:"textarea",placeholder:"请输入"},model:{value:t.formData.descriptions,callback:function(e){t.$set(t.formData,"descriptions",e)},expression:"formData.descriptions"}})],1),a("FormItem",{attrs:{label:"章节内容："}},[a("markdown-editor",{attrs:{cache:!0},model:{value:t.formData.content,callback:function(e){t.$set(t.formData,"content",e)},expression:"formData.content"}})],1)],1)],1),a("Col",{staticClass:"padding-left-20",attrs:{span:"8"}},[a("Card",[a("p",{attrs:{slot:"title"},slot:"title"},[a("Icon",{attrs:{type:"paper-airplane"}}),t._v("\n                    其它信息\n                ")],1),a("Form",{attrs:{"label-position":"right","label-width":80}},[a("FormItem",{attrs:{label:"章节序号："}},[a("Input",{attrs:{placeholder:"请输入序号"},model:{value:t.formData.weight,callback:function(e){t.$set(t.formData,"weight",e)},expression:"formData.weight"}})],1),a("FormItem",{attrs:{label:"公开度："}},[a("Icon",{attrs:{type:"eye"}}),a("div",{staticClass:"publish-time-picker-con"},[a("RadioGroup",{attrs:{vertical:""},model:{value:t.formData.access_type,callback:function(e){t.$set(t.formData,"access_type",e)},expression:"formData.access_type"}},[a("Radio",{attrs:{label:"0",value:"0"}},[t._v(" 免费")]),a("Radio",{attrs:{label:"1",value:"1"}},[t._v(" VIP")]),a("Radio",{attrs:{label:"2",value:"2"}},[t._v(" 付费")])],1)],1)],1),a("FormItem",{attrs:{label:"标签："}},[a("Select",{attrs:{multiple:"",filterable:"",placeholder:"请选择文章标签"},model:{value:t.formData.tags,callback:function(e){t.$set(t.formData,"tags",e)},expression:"formData.tags"}},t._l(t.articleTags,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name)+"\n                            ")])}))],1),a("FormItem",{attrs:{label:"新建标签"}},[a("Input",{attrs:{search:"","enter-button":"新建",placeholder:"标签名字"},on:{"on-search":t.addEditExcute},model:{value:t.newTagName,callback:function(e){t.newTagName=e},expression:"newTagName"}})],1)],1)],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:t.cancel}},[t._v("取消")]),a("Button",{attrs:{type:"primary",loading:t.saveLoading},on:{click:t.addExcute}},[t._v("保存 ")])],1),!0===t.spinLoading?a("div",{staticClass:"demo-spin-container"},[a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"spin-icon-load",attrs:{type:"load-c",size:"18"}}),a("div",[t._v("加载中...")])],1)],1):t._e()],1)],1)}),r=[],i=a("66df"),l=function(t,e,a,o){return i["a"].request({url:"/api/admin/sections",params:{page:t,per_page:e,search_data:JSON.stringify(a),article_id:o},method:"get"})},c=function(t){return i["a"].request({url:"/api/admin/sections/"+t,method:"delete"})},d=function(t){return i["a"].request({url:"/api/admin/sections",data:t,method:"post"})},m=function(t,e){return i["a"].request({url:"/api/admin/sections/"+t,data:e,method:"patch"})},u=function(t){return i["a"].request({url:"api/admin/sections/"+t,method:"get"})},p=a("d28d"),f=a("c13c"),h=a("9f69"),g=a("5e53"),v={components:{Upload:f["a"],InputHelper:h["a"],MarkdownEditor:g["a"]},data:function(){return{modalShow:!0,saveLoading:!1,spinLoading:!0,formData:{title:"",cover_image:{attachment_id:0,url:""},keywords:"",descriptions:"",content:"",weight:20,access_type:"1",tags:0,article_id:0},editOpenness:!1,newTagName:"",articleTags:{},rules:{title:[{required:!0,message:"请填章节标题",trigger:"blur"}]},imguploadConfig:{headers:{Authorization:window.access_token},format:["jpg","jpeg","png","gif"],max_size:800,upload_url:window.uploadUrl.uploadAdvertisement,file_name:"file",multiple:!1,file_num:1,default_list:[]}}},mounted:function(){this.spinLoading=!1,this.getTagListExcute(),this.formData.article_id=this.$route.params.article_id},methods:{getTagListExcute:function(){var t=this;Object(p["e"])().then(function(e){t.articleTags=e.data})},addExcute:function(){var t=this;t.$refs.formData.validate(function(e){if(e){t.saveLoading=!0;try{d(t.formData).then(function(e){t.saveLoading=!1,t.modalShow=!1,t.$emit("on-add-modal-success"),t.$emit("on-add-modal-hide"),t.$Notice.success({title:e.message})},function(e){t.saveLoading=!1})}catch(a){console.log(a)}}})},cancel:function(){this.modalShow=!1,this.$emit("on-add-modal-hide")},uploadChange:function(t,e){},addEditExcute:function(){var t=this;Object(p["a"])({name:t.newTagName}).then(function(e){t.getTagListExcute(),t.$Notice.success({title:e.message})})}}},_=v,b=a("2877"),w=Object(b["a"])(_,n,r,!1,null,null,null),D=w.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Modal",{attrs:{closable:!1,"mask-closable":!1,width:"1200"},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[a("p",{attrs:{slot:"header"},slot:"header"},[t._v("添加")]),a("Row",[a("Col",{attrs:{span:"24"}},[a("Form",{ref:"formData",attrs:{model:t.formData,rules:t.rules,"label-position":"left","label-width":100}},[a("FormItem",{attrs:{label:"文章："}},[a("Input",{attrs:{value:t.$route.query.article_title,readonly:""}})],1),a("FormItem",{attrs:{label:"标题：",prop:"title"}},[a("Input",{model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1),a("FormItem",{attrs:{label:"封面："}},[a("upload",{attrs:{"upload-config":t.imguploadConfig},on:{"on-upload-change":t.uploadChange},model:{value:t.formData.cover_image,callback:function(e){t.$set(t.formData,"cover_image",e)},expression:"formData.cover_image"}})],1),a("FormItem",{attrs:{label:"关键词：",prop:"keywords"}},[a("Input",{attrs:{type:"textarea",placeholder:"以英文逗号隔开"},model:{value:t.formData.keywords,callback:function(e){t.$set(t.formData,"keywords",e)},expression:"formData.keywords"}}),a("input-helper",{attrs:{text:"以英文逗号隔开"}})],1),a("FormItem",{attrs:{label:"描述：",prop:"description"}},[a("Input",{attrs:{type:"textarea",placeholder:"请输入"},model:{value:t.formData.descriptions,callback:function(e){t.$set(t.formData,"descriptions",e)},expression:"formData.descriptions"}})],1),a("FormItem",{attrs:{label:"章节序号："}},[a("Input",{attrs:{placeholder:"请输入序号"},model:{value:t.formData.weight,callback:function(e){t.$set(t.formData,"weight",e)},expression:"formData.weight"}})],1),a("p",{staticClass:"margin-top-10"},[a("transition",{attrs:{name:"openness-con"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.editOpenness,expression:"editOpenness"}],staticClass:"publish-time-picker-con"},[a("RadioGroup",{attrs:{vertical:""},model:{value:t.formData.access_type,callback:function(e){t.$set(t.formData,"access_type",e)},expression:"formData.access_type"}},[a("Radio",{attrs:{label:"PUB"}},[t._v(" 公开")]),a("Radio",{attrs:{label:"PWD"}},[t._v(" 密码\r\n                  "),a("Input",{directives:[{name:"show",rawName:"v-show",value:"PWD"===t.formData.access_type,expression:"formData.access_type === 'PWD'"}],staticStyle:{width:"50%"},attrs:{size:"small",placeholder:"请输入密码"},model:{value:t.formData.access_value,callback:function(e){t.$set(t.formData,"access_value",e)},expression:"formData.access_value"}})],1),a("Radio",{attrs:{label:"PRI"}},[t._v("私密")])],1),a("div",[a("Button",{attrs:{type:"primary"},on:{click:t.handleSaveOpenness}},[t._v("确认")])],1)],1)])],1),a("FormItem",{attrs:{label:"新建标签"}},[a("Input",{attrs:{search:"","enter-button":"新建",placeholder:"标签名字"},on:{"on-search":t.addEditExcute},model:{value:t.newTagName,callback:function(e){t.newTagName=e},expression:"newTagName"}})],1),a("FormItem",{attrs:{label:"标签："}},[a("Select",{attrs:{multiple:"",filterable:"",placeholder:"请选择文章标签"},model:{value:t.formData.tags,callback:function(e){t.$set(t.formData,"tags",e)},expression:"formData.tags"}},t._l(t.articleTags,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name)+" ")])}))],1),a("FormItem",{attrs:{label:"文章内容："}},[a("markdown-editor",{attrs:{cache:!0},model:{value:t.formData.content,callback:function(e){t.$set(t.formData,"content",e)},expression:"formData.content"}})],1)],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:t.cancel}},[t._v("取消")]),a("Button",{attrs:{type:"primary",loading:t.saveLoading},on:{click:t.addExcute}},[t._v("保存 ")])],1),!0===t.spinLoading?a("div",{staticClass:"demo-spin-container"},[a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"spin-icon-load",attrs:{type:"load-c",size:"18"}}),a("div",[t._v("加载中...")])],1)],1):t._e()],1)],1)},x=[],k=a("2423"),I={components:{Upload:f["a"],InputHelper:h["a"],MarkdownEditor:g["a"]},props:{articleCategories:{default:{}}},data:function(){return{modalShow:!0,saveLoading:!1,spinLoading:!0,formData:{title:"",cover_image:{attachment_id:0,url:""},enable:"F",keywords:"",descriptions:"",content:"",category_id:0,weight:20,top:"F",recommend:"F",access_type:"PUB",access_value:"",tags:0},editOpenness:!1,Openness:"公开",newTagName:"",articleTags:{},rules:{title:[{required:!0,message:"请填写文章标题",trigger:"blur"}]},imguploadConfig:{headers:{Authorization:window.access_token},format:["jpg","jpeg","png","gif"],max_size:800,upload_url:window.uploadUrl.uploadAdvertisement,file_name:"file",multiple:!1,file_num:1,default_list:[]}}},mounted:function(){this.spinLoading=!1,this.getTagListExcute()},methods:{getTagListExcute:function(){var t=this;Object(p["e"])().then(function(e){t.articleTags=e.data})},addExcute:function(){var t=this;t.$refs.formData.validate(function(e){e&&(t.saveLoading=!0,Object(k["a"])(t.formData).then(function(e){t.saveLoading=!1,t.modalShow=!1,t.$emit("on-add-modal-success"),t.$emit("on-add-modal-hide"),t.$Notice.success({title:e.message})},function(e){t.saveLoading=!1}))})},cancel:function(){this.modalShow=!1,this.$emit("on-add-modal-hide")},uploadChange:function(t,e){},handleEditOpenness:function(){this.editOpenness=!this.editOpenness},handleSaveOpenness:function(){var t=this.formData.access_type;this.passwordValidate()&&(this.Openness="PUB"===t?"公开":"PWD"===t?"密码":"私密",this.editOpenness=!1)},passwordValidate:function(){var t=this.formData.access_type,e=this.formData.access_value;if("PWD"===t){var a=/^[a-zA-Z0-9]{4,8}$/;if(!a.test(e))return this.$Notice.error({title:"出错了",desc:"密码只能是4到8位的数字与字母"}),!1}return!0},addEditExcute:function(){var t=this;Object(p["a"])({name:t.newTagName}).then(function(e){t.getTagListExcute(),t.$Notice.success({title:e.message})})}}},$=I,C=Object(b["a"])($,y,x,!1,null,null,null),F=(C.exports,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Modal",{attrs:{closable:!1,"mask-closable":!1,fullscreen:""},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[a("p",{attrs:{slot:"header"},slot:"header"},[t._v("修改")]),a("Row",[a("Col",{attrs:{span:"16"}},[a("Form",{ref:"formData",attrs:{model:t.formData,rules:t.rules,"label-position":"left","label-width":100}},[a("FormItem",{attrs:{label:"文章："}},[a("Input",{attrs:{value:t.$route.query.article_title,readonly:""}})],1),a("FormItem",{attrs:{label:"标题：",prop:"title"}},[a("Input",{model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1),a("FormItem",{attrs:{label:"封面："}},[t.formdataFinished?a("upload",{attrs:{"is-delete":!1,"upload-config":t.imguploadConfig},on:{"on-upload-change":t.uploadChange},model:{value:t.formData.cover_image,callback:function(e){t.$set(t.formData,"cover_image",e)},expression:"formData.cover_image"}}):t._e()],1),a("FormItem",{attrs:{label:"关键词：",prop:"keywords"}},[a("Input",{attrs:{type:"textarea",placeholder:"以英文逗号隔开"},model:{value:t.formData.keywords,callback:function(e){t.$set(t.formData,"keywords",e)},expression:"formData.keywords"}}),a("input-helper",{attrs:{text:"以英文逗号隔开"}})],1),a("FormItem",{attrs:{label:"描述：",prop:"description"}},[a("Input",{attrs:{type:"textarea",placeholder:"请输入"},model:{value:t.formData.descriptions,callback:function(e){t.$set(t.formData,"descriptions",e)},expression:"formData.descriptions"}})],1),a("FormItem",{attrs:{label:"文章内容："}},[t.formdataFinished?a("markdown-editor",{attrs:{cache:!1,value:t.formData.content},model:{value:t.formData.content,callback:function(e){t.$set(t.formData,"content",e)},expression:"formData.content"}}):t._e()],1)],1)],1),a("Col",{staticClass:"padding-left-20",attrs:{span:"8"}},[a("Card",[a("p",{attrs:{slot:"title"},slot:"title"},[a("Icon",{attrs:{type:"paper-airplane"}}),t._v("\n                    其它信息\n                ")],1),a("Form",{attrs:{"label-position":"right","label-width":80}},[a("FormItem",{attrs:{label:"章节序号："}},[a("Input",{attrs:{placeholder:"请输入序号"},model:{value:t.formData.weight,callback:function(e){t.$set(t.formData,"weight",e)},expression:"formData.weight"}})],1),a("FormItem",{attrs:{label:"公开度："}},[a("Icon",{attrs:{type:"eye"}}),a("div",{staticClass:"publish-time-picker-con"},[a("RadioGroup",{attrs:{vertical:""},model:{value:t.formData.access_type,callback:function(e){t.$set(t.formData,"access_type",e)},expression:"formData.access_type"}},[a("Radio",{attrs:{label:"0",value:"0"}},[t._v(" 免费")]),a("Radio",{attrs:{label:"1",value:"1"}},[t._v(" VIP")]),a("Radio",{attrs:{label:"2",value:"2"}},[t._v(" 付费")])],1)],1)],1),a("FormItem",{attrs:{label:"标签："}},[a("Select",{attrs:{multiple:"",filterable:"",placeholder:"请选择文章标签"},model:{value:t.formData.tags,callback:function(e){t.$set(t.formData,"tags",e)},expression:"formData.tags"}},t._l(t.articleTags,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name)+"\n                            ")])}))],1),a("FormItem",{attrs:{label:"新建标签"}},[a("Input",{attrs:{search:"","enter-button":"新建",placeholder:"标签名字"},on:{"on-search":t.addEditExcute},model:{value:t.newTagName,callback:function(e){t.newTagName=e},expression:"newTagName"}})],1)],1)],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:t.cancel}},[t._v("取消")]),a("Button",{attrs:{type:"primary",loading:t.saveLoading},on:{click:t.editExcute}},[t._v("保存 ")])],1),!0===t.spinLoading?a("div",{staticClass:"demo-spin-container"},[a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"spin-icon-load",attrs:{type:"load-c",size:"18"}}),a("div",[t._v("加载中...")])],1)],1):t._e()],1)],1)}),E=[],O=(a("c5f6"),{components:{Upload:f["a"],InputHelper:h["a"],MarkdownEditor:g["a"]},props:{modalId:{type:Number,default:0}},data:function(){return{modalShow:!0,saveLoading:!1,spinLoading:!0,formData:{title:"",cover_image:{attachment_id:0,url:""},keywords:"",description:"",content:"",weight:20,access_type:"1",tags:0,article_id:0},formdataFinished:!1,editOpenness:!1,newTagName:"",articleTags:{},rules:{title:[{required:!0,message:"请填写文章标题",trigger:"blur"}]},imguploadConfig:{headers:{Authorization:window.access_token},format:["jpg","jpeg","png","gif"],max_size:800,upload_url:window.uploadUrl.uploadAdvertisement,file_name:"file",multiple:!1,file_num:1,default_list:[]}}},mounted:function(){this.getTagListExcute(),this.getInfoByIdExcute()},methods:{getTagListExcute:function(){var t=this;Object(p["e"])().then(function(e){t.articleTags=e.data})},getInfoByIdExcute:function(){var t=this;u(t.modalId).then(function(e){var a=e.data;console.log(a),t.formData={id:a.id,title:a.title,keywords:a.keywords,descriptions:a.descriptions,category_id:a.category_id,weight:a.weight,access_type:a.access_type+"",cover_image:{attachment_id:a.cover_image.attachment_id,url:a.cover_image.url},article_id:a.article_id},console.log(t.formData),t.formData.cover_image.attachment_id&&(t.imguploadConfig.default_list=[t.formData.cover_image]),t.formData.tags=a.tagids,t.formData.content=a.content.raw,t.formdataFinished=!0,t.spinLoading=!1})},editExcute:function(){var t=this;t.$refs.formData.validate(function(e){e&&(t.saveLoading=!0,m(t.modalId,t.formData).then(function(e){t.saveLoading=!1,t.modalShow=!1,t.$emit("on-edit-modal-success"),t.$emit("on-edit-modal-hide"),t.$Notice.success({title:e.message})},function(e){t.saveLoading=!1}))})},cancel:function(){this.modalShow=!1,this.$emit("on-edit-modal-hide")},uploadChange:function(t,e){},addEditExcute:function(){var t=this;Object(p["a"])({name:t.newTagName}).then(function(e){t.getTagListExcute(),t.$Notice.success({title:e.message})})}}}),S=O,T=Object(b["a"])(S,F,E,!1,null,null,null),L=T.exports,N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Modal",{attrs:{closable:!1,"mask-closable":!1,width:"1200"},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[a("p",{attrs:{slot:"header"},slot:"header"},[t._v("修改")]),a("Row",[a("Col",{attrs:{span:"24"}},[a("Form",{ref:"formData",attrs:{model:t.formData,rules:t.rules,"label-position":"left","label-width":100}},[a("FormItem",{attrs:{label:"分类："}},[a("Select",{attrs:{filterable:"",placeholder:"请选择文章分类"},model:{value:t.formData.category_id,callback:function(e){t.$set(t.formData,"category_id",e)},expression:"formData.category_id"}},t._l(t.articleCategories,function(e,o){return a("Option",{key:o,attrs:{value:e.id}},[t._v(t._s(e.name)+" ")])}))],1),a("FormItem",{attrs:{label:"标题：",prop:"title"}},[a("Input",{model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1),a("FormItem",{attrs:{label:"封面："}},[t.formdataFinished?a("upload",{attrs:{"is-delete":!1,"upload-config":t.imguploadConfig},on:{"on-upload-change":t.uploadChange},model:{value:t.formData.cover_image,callback:function(e){t.$set(t.formData,"cover_image",e)},expression:"formData.cover_image"}}):t._e()],1),a("FormItem",{attrs:{label:"是否启用："}},[a("RadioGroup",{model:{value:t.formData.enable,callback:function(e){t.$set(t.formData,"enable",e)},expression:"formData.enable"}},[a("Radio",{attrs:{label:"F"}},[t._v("禁用")]),a("Radio",{attrs:{label:"T"}},[t._v("启用")])],1)],1),a("FormItem",{attrs:{label:"关键词：",prop:"keywords"}},[a("Input",{attrs:{type:"textarea",placeholder:"以英文逗号隔开"},model:{value:t.formData.keywords,callback:function(e){t.$set(t.formData,"keywords",e)},expression:"formData.keywords"}}),a("input-helper",{attrs:{text:"以英文逗号隔开"}})],1),a("FormItem",{attrs:{label:"描述：",prop:"description"}},[a("Input",{attrs:{type:"textarea",placeholder:"请输入"},model:{value:t.formData.descriptions,callback:function(e){t.$set(t.formData,"descriptions",e)},expression:"formData.descriptions"}})],1),a("FormItem",{attrs:{label:"排序："}},[a("Input",{attrs:{placeholder:"请输入序号"},model:{value:t.formData.weight,callback:function(e){t.$set(t.formData,"weight",e)},expression:"formData.weight"}})],1),a("FormItem",{attrs:{label:"置顶："}},[a("Select",{staticStyle:{width:"20%"},attrs:{size:"small"},model:{value:t.formData.top,callback:function(e){t.$set(t.formData,"top",e)},expression:"formData.top"}},[a("Option",{attrs:{value:"F"}},[t._v("否")]),a("Option",{attrs:{value:"T"}},[t._v("是")])],1)],1),a("FormItem",{attrs:{label:"推荐："}},[a("Select",{staticStyle:{width:"20%"},attrs:{size:"small"},model:{value:t.formData.recommend,callback:function(e){t.$set(t.formData,"recommend",e)},expression:"formData.recommend"}},[a("Option",{attrs:{value:"F"}},[t._v("否")]),a("Option",{attrs:{value:"T"}},[t._v("是")])],1)],1),a("FormItem",{attrs:{label:"公开度："}},[a("Icon",{attrs:{type:"eye"}}),a("b",[t._v(t._s(t.Openness))]),a("Button",{directives:[{name:"show",rawName:"v-show",value:!t.editOpenness,expression:"!editOpenness"}],attrs:{size:"small",type:"text"},on:{click:t.handleEditOpenness}},[a("a",[t._v("修改")])]),a("transition",{attrs:{name:"openness-con"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.editOpenness,expression:"editOpenness"}],staticClass:"publish-time-picker-con"},[a("RadioGroup",{attrs:{vertical:""},model:{value:t.formData.access_type,callback:function(e){t.$set(t.formData,"access_type",e)},expression:"formData.access_type"}},[a("Radio",{attrs:{label:"PUB"}},[t._v(" 公开")]),a("Radio",{attrs:{label:"PWD"}},[t._v(" 密码\r\n                  "),a("Input",{directives:[{name:"show",rawName:"v-show",value:"PWD"===t.formData.access_type,expression:"formData.access_type === 'PWD'"}],staticStyle:{width:"50%"},attrs:{size:"small",placeholder:"请输入密码"},model:{value:t.formData.access_value,callback:function(e){t.$set(t.formData,"access_value",e)},expression:"formData.access_value"}})],1),a("Radio",{attrs:{label:"PRI"}},[t._v("私密")])],1),a("div",[a("Button",{attrs:{type:"primary"},on:{click:t.handleSaveOpenness}},[t._v("确认")])],1)],1)])],1),a("FormItem",{attrs:{label:"新建标签"}},[a("Input",{attrs:{search:"","enter-button":"新建",placeholder:"标签名字"},on:{"on-search":t.addEditExcute},model:{value:t.newTagName,callback:function(e){t.newTagName=e},expression:"newTagName"}})],1),a("FormItem",{attrs:{label:"标签："}},[a("Select",{attrs:{multiple:"",filterable:"",placeholder:"请选择文章标签"},model:{value:t.formData.tags,callback:function(e){t.$set(t.formData,"tags",e)},expression:"formData.tags"}},t._l(t.articleTags,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name)+" ")])}))],1),a("FormItem",{attrs:{label:"文章内容："}},[t.formdataFinished?a("markdown-editor",{attrs:{cache:!1,value:t.formData.content},model:{value:t.formData.content,callback:function(e){t.$set(t.formData,"content",e)},expression:"formData.content"}}):t._e()],1)],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:t.cancel}},[t._v("取消")]),a("Button",{attrs:{type:"primary",loading:t.saveLoading},on:{click:t.editExcute}},[t._v("保存 ")])],1),!0===t.spinLoading?a("div",{staticClass:"demo-spin-container"},[a("Spin",{attrs:{fix:""}},[a("Icon",{staticClass:"spin-icon-load",attrs:{type:"load-c",size:"18"}}),a("div",[t._v("加载中...")])],1)],1):t._e()],1)],1)},P=[],M={components:{Upload:f["a"],InputHelper:h["a"],MarkdownEditor:g["a"]},props:{articleCategories:{default:{}},modalId:{type:Number,default:0}},data:function(){return{modalShow:!0,saveLoading:!1,spinLoading:!0,formData:{title:"",cover_image:{attachment_id:0,url:""},enable:"F",keywords:"",description:"",content:"",category_id:0,weight:20,top:"F",recommend:"F",access_type:"PUB",access_value:""},formdataFinished:!1,editOpenness:!1,Openness:"公开",newTagName:"",articleTags:{},rules:{title:[{required:!0,message:"请填写文章标题",trigger:"blur"}]},imguploadConfig:{headers:{Authorization:window.access_token},format:["jpg","jpeg","png","gif"],max_size:800,upload_url:window.uploadUrl.uploadAdvertisement,file_name:"file",multiple:!1,file_num:1,default_list:[]}}},mounted:function(){this.getTagListExcute(),this.getInfoByIdExcute()},methods:{getTagListExcute:function(){var t=this;Object(p["e"])().then(function(e){t.articleTags=e.data})},getInfoByIdExcute:function(){var t=this;Object(k["e"])(t.modalId).then(function(e){var a=e.data;t.formData={id:a.id,title:a.title,cover_image:{attachment_id:a.cover_image.attachment_id,url:a.cover_image.url},enable:a.enable,keywords:a.keywords,descriptions:a.descriptions,category_id:a.category_id,weight:a.weight,top:a.top,recommend:a.recommend,access_type:a.access_type,access_value:a.access_value},t.handleSaveOpenness(),t.imguploadConfig.default_list=[t.formData.cover_image],t.formData.tags=a.tagids,t.formData.content=a.content.raw,t.formdataFinished=!0,t.spinLoading=!1})},editExcute:function(){var t=this;t.$refs.formData.validate(function(e){e&&(t.saveLoading=!0,Object(k["c"])(t.modalId,t.formData).then(function(e){t.saveLoading=!1,t.modalShow=!1,t.$emit("on-edit-modal-success"),t.$emit("on-edit-modal-hide"),t.$Notice.success({title:e.message})},function(e){t.saveLoading=!1}))})},cancel:function(){this.modalShow=!1,this.$emit("on-edit-modal-hide")},uploadChange:function(t,e){},handleEditOpenness:function(){this.editOpenness=!this.editOpenness},handleSaveOpenness:function(){var t=this.formData.access_type;this.passwordValidate()&&(this.Openness="PUB"===t?"公开":"PWD"===t?"密码":"私密",this.editOpenness=!1)},passwordValidate:function(){var t=this.formData.access_type,e=this.formData.access_value;if("PWD"===t){var a=/^[a-zA-Z0-9]{4,8}$/;if(!a.test(e))return this.$Notice.error({title:"出错了",desc:"密码只能是4到8位的数字与字母"}),!1}return!0},addEditExcute:function(){var t=this;Object(p["a"])({name:t.newTagName}).then(function(e){t.getTagListExcute(),t.$Notice.success({title:e.message})})}}},j=M,z=Object(b["a"])(j,N,P,!1,null,null,null),B=(z.exports,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Drawer",{attrs:{closable:!0,title:"详情",width:t.platformIsPc?30:80},on:{"on-close":t.closed},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("p",{staticClass:"drawer-title"},[t._v("基本资料：")]),a("div",{staticClass:"drawer-profile"},[a("Row",[a("Col",{attrs:{span:"12"}},[t._v(" Slug: "+t._s(t.info.slug)+" ")]),a("Col",{attrs:{span:"12"}},[t._v(" 作者： "+t._s(t.info.user.name)+" ")]),a("Col",{attrs:{span:"12"}},[t._v(" 访问方式：\r\n        "),"0"==t.info.access_type?a("span",{staticClass:"green-color"},[t._v(" 免费  ")]):"1"==t.info.access_type?a("span",{staticClass:"green-color"},[t._v("  VIP  ")]):a("span",{staticClass:"green-color"},[t._v("  付费  ")])])],1),a("hr",{staticClass:"hr-line-0"}),a("p",{staticClass:"drawer-title"},[t._v("内容：")]),a("p",{staticClass:"content"},[a("parse",{attrs:{content:t.info.content.raw}})],1)],1)])],1)}),R=[],q=a("2846"),W={props:{info:{type:Object,default:""}},components:{Parse:q["a"]},data:function(){return{show:!0,agreement:"",spinLoading:!0}},created:function(){},computed:{platformIsPc:function(){return"pc"==this.globalPlatformType()}},methods:{closed:function(){this.show=!1,this.$emit("show-modal-close")}}},U=W,A=Object(b["a"])(U,B,R,!1,null,null,null),H=A.exports,V=a("2934"),G={components:{AddComponent:D,EditComponent:L,ShowInfo:H},data:function(){var t=this;return{article_id:0,searchForm:{order_by:"id,desc",title:""},tableLoading:!1,tableStatus:{enable:[]},feeds:{data:[],total:0,current_page:1,per_page:10},tagList:{},addModal:{show:!1},editModal:{show:!1,id:0},showInfoModal:{show:!1,info:""},columns:[{title:"ID",key:"id",sortable:"customer",minWidth:50},{title:"标题",key:"title",minWidth:150},{title:"封面",minWidth:150,render:function(t,e){if(e.row.cover_image.url)return t("div",[t("img",{attrs:{src:e.row.cover_image.url,class:"fancybox",href:e.row.cover_image.url,title:"图片"},style:{width:"40px",height:"40px"}})])}},{title:"标签",minWidth:100,render:function(t,e){var a=e.row.tags,o="";for(var s in a)o+=s<1?a[s].name:"、"+a[s].name;return t("div",o)}},{title:"创建时间",sortable:"customer",key:"created_at",minWidth:150},{title:"操作",minWidth:200,render:function(e,a){var o=t,s="";return s=e("Poptip",{props:{confirm:!0,title:"您确定要删除「"+a.row.title+"」？",transfer:!0},on:{"on-ok":function(){o.destroyExcute(a.row.id,a.index)}}},[e("Button",{style:{margin:"0 5px"},props:{type:"error",size:"small",placement:"top"}},"删除")]),e("div",[e("Button",{style:{margin:"0 5px"},props:{type:"primary",size:"small"},on:{click:function(){t.showInfoModal.show=!0,t.showInfoModal.info=a.row}}},"详细"),e("Button",{props:{type:"success",size:"small"},on:{click:function(){t.editModal.show=!0,t.editModal.id=a.row.id}}},"修改"),s])}}]}},mounted:function(){var t=this;this.article_id=t.$route.params.article_id,t.getTableDataExcute(t.feeds.current_page)},computed:{},methods:{handleOnPageChange:function(t){this.getTableDataExcute(t)},onPageSizeChange:function(t){this.feeds.per_page=t,this.getTableDataExcute(this.feeds.current_page)},getTableStatusExcute:function(t){var e=this;Object(V["b"])(t).then(function(t){var a=t.data;e.tableStatus.enable=a.enable,e.tableStatus.recommend=a.recommend,e.tableStatus.top=a.top})},getTableDataExcute:function(t){var e=this;e.tableLoading=!0,e.feeds.current_page=t,l(t,e.feeds.per_page,e.searchForm,e.article_id).then(function(t){e.feeds.data=t.data,e.feeds.total=t.meta.total,e.tableLoading=!1,e.globalFancybox()},function(t){e.tableLoading=!1})},onSortChange:function(t){var e=t.column.key+","+t.order;this.searchForm.order_by=e,this.getTableDataExcute(this.feeds.current_page)},switchEnableExcute:function(t){var e=this,a="T";"T"===e.feeds.data[t].enable&&(a="F"),Object(V["c"])(e.feeds.data[t].id,"articles",a).then(function(o){e.feeds.data[t].enable=a,e.$Notice.success({title:o.message})})},destroyExcute:function(t,e){var a=this;c(t).then(function(t){a.feeds.data.splice(e,1),a.$Notice.success({title:t.message})})},addBtn:function(){this.addModal.show=!0},addModalHide:function(){this.addModal.show=!1},editModalHide:function(){this.editModal.show=!1},showModalClose:function(){this.showInfoModal.show=!1}}},J=G,Z=Object(b["a"])(J,o,s,!1,null,null,null);e["default"]=Z.exports},d28d:function(t,e,a){"use strict";a.d(e,"d",function(){return s}),a.d(e,"e",function(){return n}),a.d(e,"c",function(){return r}),a.d(e,"a",function(){return i}),a.d(e,"b",function(){return l});var o=a("66df"),s=function(t,e,a){return o["a"].request({url:"/api/admin/tags",params:{page:t,per_page:e,search_data:JSON.stringify(a)},method:"get"})},n=function(){return o["a"].request({url:"/api/admin/tags",method:"get"})},r=function(t){return o["a"].request({url:"api/admin/tags/"+t,method:"get"})},i=function(t){return o["a"].request({url:"/api/admin/tags",data:t,method:"post"})},l=function(t){return o["a"].request({url:"/api/admin/tags/"+t,method:"delete"})}}}]);